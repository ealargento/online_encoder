<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8"/>
    <title>Webcam webcaster</title>


    <link href="//cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/2.3.2/css/bootstrap.min.css" rel="stylesheet" media="screen">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.10.3/css/base/jquery.ui.all.min.css" rel="stylesheet" media="screen">
    <link href="css/client.css" rel="stylesheet" media="screen">

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.10.0/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.10.3/jquery-ui.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/2.3.2/js/bootstrap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.5.1/underscore-min.js"></script>
    <Script src="https://cdnjs.cloudflare.com/ajax/libs/backbone.js/1.0.0/backbone-min.js"></script>

    <script src="https://cdn.jsdelivr.net/gh/webcast/taglib.js@master/dist/taglib.js"></script>
    <script>var exports = {};</script>
    <script src="https://cdn.jsdelivr.net/gh/webcast/webcast.js@main/dist/webcast.js"></script>

    <script>


    const url="ws://source:hackme@localhost:8080/mount";

    navigator.mediaDevices.getUserMedia(
      // constraints - only audio needed for this app
      {
        audio: true,
        video: false

      },

    ).then((stream) => {

      console.log(stream)

      const mediaRecorder= new MediaRecorder(stream,{ mimeType: "audio/webm;codecs=opus"})


      const ws = new Webcast.Socket({
        mediaRecorder: mediaRecorder,
        url: url,
        info: {}
      })

      console.log(ws)

      mediaRecorder.start(1000);
      //console.log(mediaRecorder)

    })





    </script>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="main.css">
  </head>

  <body>
    <h1>Webcam webcaster</h1>
    <p>
      Simple demo example to send your webcam using webcaster. Press start
      button to begin. A demo server
      using <a href="https://www.liquidsoap.info/">Liquidsoap</a> is provided
      in <tt>server.liq</tt>.
    </p>

    <p>
      <button id="start" type="button">Start</button>
      <button id="stop" type="button">Stop</button>
    </p>

    <p>
      <video id="video" autoplay="true" controls muted></video>
    </p>

    <form id="server-params">
      <label>Server</label>
      <input id="server" value="localhost">
      <label>Port</label>
      <input id="port" type="number" value="8000">
      <label>Mount</label>
      <input id="mount" value="mount">
      <label>User</label>
      <input id="user" value="source">
      <label>Pass</label>
      <input id="password" value="hackme">
    </form>
  </body>
</html>
